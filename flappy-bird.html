<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Flappy Bird</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(180deg, #4dc9e6 0%, #87ceeb 100%);
      font-family: 'Arial', sans-serif;
      overflow: hidden;
      touch-action: manipulation;
    }
    #gameContainer {
      position: relative;
      width: 100vw;
      height: 100vh;
      max-width: 480px;
      max-height: 800px;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
      border-radius: 0;
    }
    #startScreen, #gameOverScreen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: rgba(0,0,0,0.5);
      color: white;
      text-align: center;
      padding: 20px;
    }
    #gameOverScreen {
      display: none;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      text-shadow: 3px 3px 0 #000;
      color: #fff700;
    }
    .score-display {
      font-size: 1.8rem;
      margin: 10px 0;
    }
    .instruction {
      font-size: 1.2rem;
      margin-top: 30px;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    #currentScore {
      position: absolute;
      top: 50px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
      font-weight: bold;
      color: white;
      text-shadow: 2px 2px 0 #000, -2px -2px 0 #000, 2px -2px 0 #000, -2px 2px 0 #000;
      z-index: 10;
      display: none;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <canvas id="game"></canvas>
    <div id="currentScore">0</div>
    
    <div id="startScreen">
      <h1>üê¶ Flappy Bird</h1>
      <p class="instruction">Tap to Start & Fly</p>
    </div>
    
    <div id="gameOverScreen">
      <h1>Game Over</h1>
      <p class="score-display">Score: <span id="finalScore">0</span></p>
      <p class="score-display">Best: <span id="bestScore">0</span></p>
      <p class="instruction">Tap to Play Again</p>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const container = document.getElementById('gameContainer');
    const startScreen = document.getElementById('startScreen');
    const gameOverScreen = document.getElementById('gameOverScreen');
    const currentScoreEl = document.getElementById('currentScore');
    const finalScoreEl = document.getElementById('finalScore');
    const bestScoreEl = document.getElementById('bestScore');

    // Set canvas size
    function resizeCanvas() {
      canvas.width = container.clientWidth;
      canvas.height = container.clientHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Game variables
    let gameState = 'start'; // start, playing, gameOver
    let score = 0;
    let bestScore = localStorage.getItem('flappyBest') || 0;
    bestScoreEl.textContent = bestScore;

    // Bird
    const bird = {
      x: 0,
      y: 0,
      width: 40,
      height: 30,
      velocity: 0,
      gravity: 0.6,
      jumpStrength: -10,
      rotation: 0
    };

    // Pipes
    let pipes = [];
    const pipeWidth = 70;
    const pipeGap = 180;
    let pipeSpeed = 3;
    let pipeSpawnTimer = 0;
    const pipeSpawnInterval = 90;

    // Ground
    const groundHeight = 80;
    let groundX = 0;

    function resetGame() {
      bird.x = canvas.width * 0.25;
      bird.y = canvas.height * 0.4;
      bird.velocity = 0;
      bird.rotation = 0;
      pipes = [];
      score = 0;
      pipeSpawnTimer = 0;
      currentScoreEl.textContent = '0';
    }

    function jump() {
      if (gameState === 'start') {
        gameState = 'playing';
        startScreen.style.display = 'none';
        currentScoreEl.style.display = 'block';
        resetGame();
      } else if (gameState === 'playing') {
        bird.velocity = bird.jumpStrength;
      } else if (gameState === 'gameOver') {
        gameState = 'playing';
        gameOverScreen.style.display = 'none';
        currentScoreEl.style.display = 'block';
        resetGame();
      }
    }

    // Input handlers
    document.addEventListener('touchstart', (e) => {
      e.preventDefault();
      jump();
    }, { passive: false });
    
    document.addEventListener('mousedown', jump);
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') jump();
    });

    function spawnPipe() {
      const minHeight = 80;
      const maxHeight = canvas.height - groundHeight - pipeGap - minHeight;
      const topHeight = Math.random() * maxHeight + minHeight;
      
      pipes.push({
        x: canvas.width,
        topHeight: topHeight,
        bottomY: topHeight + pipeGap,
        passed: false
      });
    }

    function update() {
      if (gameState !== 'playing') return;

      // Bird physics
      bird.velocity += bird.gravity;
      bird.y += bird.velocity;
      bird.rotation = Math.min(Math.max(bird.velocity * 3, -30), 90);

      // Pipe spawning
      pipeSpawnTimer++;
      if (pipeSpawnTimer >= pipeSpawnInterval) {
        spawnPipe();
        pipeSpawnTimer = 0;
      }

      // Update pipes
      for (let i = pipes.length - 1; i >= 0; i--) {
        pipes[i].x -= pipeSpeed;

        // Score
        if (!pipes[i].passed && pipes[i].x + pipeWidth < bird.x) {
          pipes[i].passed = true;
          score++;
          currentScoreEl.textContent = score;
        }

        // Remove off-screen pipes
        if (pipes[i].x + pipeWidth < 0) {
          pipes.splice(i, 1);
        }
      }

      // Ground scroll
      groundX -= pipeSpeed;
      if (groundX <= -50) groundX = 0;

      // Collision detection
      checkCollisions();
    }

    function checkCollisions() {
      // Ground/ceiling
      if (bird.y + bird.height > canvas.height - groundHeight || bird.y < 0) {
        gameOver();
        return;
      }

      // Pipes
      for (const pipe of pipes) {
        if (bird.x + bird.width - 10 > pipe.x && bird.x + 10 < pipe.x + pipeWidth) {
          if (bird.y + 5 < pipe.topHeight || bird.y + bird.height - 5 > pipe.bottomY) {
            gameOver();
            return;
          }
        }
      }
    }

    function gameOver() {
      gameState = 'gameOver';
      currentScoreEl.style.display = 'none';
      
      if (score > bestScore) {
        bestScore = score;
        localStorage.setItem('flappyBest', bestScore);
      }
      
      finalScoreEl.textContent = score;
      bestScoreEl.textContent = bestScore;
      gameOverScreen.style.display = 'flex';
    }

    function draw() {
      // Sky gradient
      const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
      gradient.addColorStop(0, '#4dc9e6');
      gradient.addColorStop(1, '#87ceeb');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Clouds
      ctx.fillStyle = 'rgba(255,255,255,0.8)';
      drawCloud(50, 80, 60);
      drawCloud(200, 150, 45);
      drawCloud(320, 60, 55);

      // Pipes
      for (const pipe of pipes) {
        // Top pipe
        ctx.fillStyle = '#73bf2e';
        ctx.fillRect(pipe.x, 0, pipeWidth, pipe.topHeight);
        ctx.fillStyle = '#5a9a23';
        ctx.fillRect(pipe.x - 5, pipe.topHeight - 30, pipeWidth + 10, 30);
        
        // Bottom pipe
        ctx.fillStyle = '#73bf2e';
        ctx.fillRect(pipe.x, pipe.bottomY, pipeWidth, canvas.height - pipe.bottomY - groundHeight);
        ctx.fillStyle = '#5a9a23';
        ctx.fillRect(pipe.x - 5, pipe.bottomY, pipeWidth + 10, 30);
      }

      // Ground
      ctx.fillStyle = '#ded895';
      ctx.fillRect(0, canvas.height - groundHeight, canvas.width, groundHeight);
      ctx.fillStyle = '#5cb85c';
      ctx.fillRect(0, canvas.height - groundHeight, canvas.width, 20);

      // Bird
      ctx.save();
      ctx.translate(bird.x + bird.width / 2, bird.y + bird.height / 2);
      ctx.rotate(bird.rotation * Math.PI / 180);
      
      // Body
      ctx.fillStyle = '#f7dc6f';
      ctx.beginPath();
      ctx.ellipse(0, 0, bird.width / 2, bird.height / 2, 0, 0, Math.PI * 2);
      ctx.fill();
      
      // Wing
      ctx.fillStyle = '#f0b429';
      ctx.beginPath();
      ctx.ellipse(-5, 5, 12, 8, -0.3, 0, Math.PI * 2);
      ctx.fill();
      
      // Eye
      ctx.fillStyle = 'white';
      ctx.beginPath();
      ctx.arc(10, -5, 8, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = 'black';
      ctx.beginPath();
      ctx.arc(12, -5, 4, 0, Math.PI * 2);
      ctx.fill();
      
      // Beak
      ctx.fillStyle = '#e74c3c';
      ctx.beginPath();
      ctx.moveTo(15, 2);
      ctx.lineTo(28, 5);
      ctx.lineTo(15, 10);
      ctx.closePath();
      ctx.fill();
      
      ctx.restore();
    }

    function drawCloud(x, y, size) {
      ctx.beginPath();
      ctx.arc(x, y, size * 0.5, 0, Math.PI * 2);
      ctx.arc(x + size * 0.4, y - size * 0.2, size * 0.4, 0, Math.PI * 2);
      ctx.arc(x + size * 0.8, y, size * 0.45, 0, Math.PI * 2);
      ctx.fill();
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    resetGame();
    gameLoop();
  </script>
</body>
</html>
